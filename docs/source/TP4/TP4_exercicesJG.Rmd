--- 
title: "TP3 Analyse differentielle" 
author: 
- Justine Guégan - j.guegan-ihu@icm-institute.org 
- Guillaume Meurice - guillaume.meurice@gustaveroussy.fr 
date: "08 décembre 2016" 
output: pdf_document 
header- includes: 
- \usepackage{nicefrac} 
- \usepackage{graphicx} 
- \newcommand{\cor}{cor} 
---

Les données nécessaires à cette séance se trouvent sur le site web :

https://pf-bb.github.io/CentraleSupelec-R-genomics/TP4.html.

# Objectif

Dans les TP2 et 3, nous avons appris à manipuler des données d'expressions, à évaluer la variabilité de profils transcritpionnels, 
et à rechercher des gènes différentiellement exprimés entre deux groupes d'echantillons. Aujourd'hui, nous nous pencherons
sur l'analyse fonctionnelle de ces gènes : quels sont les mécanismes biologiques sous jascent, si tant est que nous puissions les 
identifier ?

Répondez aux questions dans un document Rmarkdown produisant un fichier **PDF** ou **HTML**.

# Données

Les ARNm de 17 échantillons de tumeurs du sein de 3 types, HER2 positif (HER2), triple négatif (TNBC), non triple négatif (Non-TNBC), et 3 échantillons de sein normal (NBS) ont été séquencés par Illumina HiSeq2000. 

# Analyse des données

Lors du TP précedent, vous aviez généré les MA-plot, des volcanoplots et des heatmap permettant de représenter les gènes différentiellements 
exprimés entre deux groupes d'échantillons. Afin de repartir sur la même base, nous vous donnons aujourd'hui les fichiers suivant : 

* Fichier des comptages normalisés : counts_normalized.txt
* Fichier d'annotation des échantillons : annot_sample.txt
* Fichiers de liste de gènes : ces fichiers contiennent simplement la liste des gènes sur- et sous-exprimés dans les 3 contrastes : 

>* gene_list_HER2_vs_NBS_up.txt
>* gene_list_HER2_vs_NBS_dn.txt
>* gene_list_TNBC_vs_NBS_up.txt
>* gene_list_TNBC_vs_NBS_dn.txt
>* gene_list_NTNBC_vs_NBS_up.txt
>* gene_list_NTNBC_vs_NBS_dn.txt

note : pour répondre aux questions de ce TP, il faudra charger ces fichiers dans R. Pour cela, n'oubliez pas les options `header = TRUE`, 
`row.names = 1` et `sep = "\t"`

**1. Un peu de Biologie **

> **Question 1.1**:  Trouvez une brève définition des 3 sous types de cancer. Identifiez pour chaque sous-type, le ou les gènes caractéristiques. Ces informations sont définies dans les 2 articles indiqués sur le site web du TP.

```{r Q1.1 Definition, eval = FALSE, echo = FALSE}
# HER2
# Le récepteur HER2 fait partie de la famille des récepteurs EGFR (pour Epithelial Growth Factor Receptor). L’Epithelial Growth Factor est 
# impliqué dans la régulation de la prolifération et de la survie des cellules et, en particulier, des cellules cancéreuses.
# les scientifiques ont démontré que l’hyperactivité de ce gène HER2 était liée à une forme plus agressive de cancer du sein.


# TNBC : Triple Negative Breast cancer.
# Il s'agit d'une catégorie de cancer du sein n'exprimant pas les recepteurs aux progesterones (PR), aux estrogenes (ER), ni le recepteur HER2.
# Le developpement de ce type de tumeur ne depend pas des hormones de type estrogene ou progesterone, ni par les facteurs de croissance associés à HER2.  ce type de tumeur ne répond pas aux therapies hormonales, et nécessitent d'autres stratégies.

# NTNBC : Non TNBC : sous type de cancer du sein étant positif pour l'expression des gènes HER2, ER et PR
```


> **Question 1.2**:  

> * Retrouvez les gènes cités précédemment dans notre jeu de données (différents noms peuvent exister pour un même gène = alias. Les noms de gènes sont appelés des *HGNC Gene Symbol*). 
> * Création des graphiques permettant de visualiser les mesures d'expression de ces gènes :   
Créez un graphique par gène avec en abscisse les 4 conditions et en ordonnée les comptages normalisés. Supprimer les labels des abscisses en précisant l'argument `xaxt='none'`. Vous pouvez ensuite personnaliser les labels des abscisses grâce à la fonction `axis()`.    
Cela vous parait-il cohérent avec ce que l'on pourrait attendre ? 

```{r Q1.2a, eval = FALSE, echo = FALSE}
annot  = read.table("data_TP4/annot_sample.txt", sep="\t", header=TRUE)
counts = read.table("data_TP4/counts_normalized.txt", sep="\t", header=T, row.names=1)
idxERBB2 = which(rownames(counts) == "ERBB2")
idxPR   = which(rownames(counts) == "PGR")
idxER   = which(rownames(counts) == "ESR1")

idxHER2 = which(annot$condition == "HER2")
idxTNBC = which(annot$condition == "TNBC")
idxNTNBC = which(annot$condition == "Non-TNBC")
idxNBS = which(annot$condition == "NBS")
```


```{r Q1.2b Profil d'expression, eval = FALSE, echo = FALSE}
par(mfrow=c(3,1))
plot(annot$condition, counts[idxERBB2, ], 
     pch = 16, xaxt = 'n', ylab = 'counts', xlab='condition', 
     main = "ERBB2 Gene, HER2 positive")
axis(1, labels= annot$condition, at= annot$condition )

plot(annot$condition, counts[idxPR, ], 
     pch = 16, xaxt = 'n', ylab = 'counts', xlab='condition', 
     main = "PGR Gene, Progesteron Receptor")
axis(1, labels= annot$condition, at= annot$condition )

plot(annot$condition, counts[idxER, ], 
     pch = 16, xaxt = 'n', ylab = 'counts', xlab='condition', 
     main = "ESR1 Gene, Estrogen Receptor ")
axis(1, labels= annot$condition, at= annot$condition )

```


** 2 Analyse fonctionnelle **

Dans cette partie, on se propose d'explorer les listes de gènes

** Question 2.1 ** 





